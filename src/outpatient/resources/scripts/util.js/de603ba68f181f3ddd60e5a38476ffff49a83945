/*de603ba68f181f3ddd60e5a38476ffff49a83945*/Ext.apply(Ext.form.VTypes,{phone:function(a,b){return a.replace(/[ \-\(\)]/g,"").length==10},phoneText:"Invalid, number must be 10 digits",phoneMask:/[ \d\-\(\)]/});LAB_HOST="http://openmrs.gielow.me/openmrs-1.8.4";LAB_USERNAME="Admin";LAB_PASSWORD="Admin123";var HOST;var DEFAULT_HOST="http://test.raxa.org:8080/openmrs";if(localStorage.getItem("host")===null){HOST=DEFAULT_HOST}else{HOST=localStorage.getItem("host")}var username;var password;var timeoutLimit=150000;var hospitalName="JSS Hospital";var resourceUuid={tablet:{resource:"concept",queryTerm:"tablet",varName:"tablet",displayName:"TABLET"},ointment:{resource:"concept",queryTerm:"ointment",varName:"ointment",displayName:"OINTMENT"},syrup:{resource:"concept",queryTerm:"syrup",varName:"syrup",displayName:"SYRUP"},solutionForInjection:{resource:"concept",queryTerm:"solution for injection",varName:"solutionForInjection",displayName:"SOLUTION FOR INJECTION"},capsule:{resource:"concept",queryTerm:"capsule",varName:"capsule",displayName:"CAPSULE"},capsule:{resource:"concept",queryTerm:"capsule",varName:"capsule",displayName:"CAPSULE"},height:{resource:"concept",queryTerm:"height",varName:"height",displayName:"HEIGHT (CM)"},weight:{resource:"concept",queryTerm:"weight",varName:"weight",displayName:"WEIGHT (KG)"},bmi:{resource:"concept",queryTerm:"bmi",varName:"bmi",displayName:"BODY MASS INDEX"},regfee:{resource:"concept",queryTerm:"regfee",varName:"regfee",displayName:"REGISTRATION FEE"},systolicbloodpressure:{resource:"concept",queryTerm:"SYSTOLIC BLOOD PRESSURE",varName:"systolicbloodpressure",displayName:"SYSTOLIC BLOOD PRESSURE"},diastolicbloodpressure:{resource:"concept",queryTerm:"DIASTOLIC BLOOD PRESSURE",varName:"diastolicbloodpressure",displayName:"DIASTOLIC BLOOD PRESSURE"},pulse:{resource:"concept",queryTerm:"pulse",varName:"pulse",displayName:"PULSE"},respiratoryRate:{resource:"concept",queryTerm:"RESPIRATORY RATE",varName:"respiratoryRate",displayName:"RESPIRATORY RATE"},temperature:{resource:"concept",queryTerm:"TEMPERATURE",varName:"temperature",displayName:"TEMPERATURE (C)"},bloodoxygensaturation:{resource:"concept",queryTerm:"BLOOD OXYGEN SATURATION",varName:"bloodoxygensaturation",displayName:"BLOOD OXYGEN SATURATION"},referred:{resource:"concept",queryTerm:"REFERRER",varName:"referred",displayName:"REFERRING PERSON"},notes:{resource:"concept",queryTerm:"REGISTRATION NOTES",varName:"notes",displayName:"REGISTRATION NOTES"},regcomplaint:{resource:"concept",queryTerm:"REGISTRATION COMPLAINT",varName:"regcomplaint",displayName:"REGISTRATION COMPLAINT"},basic:{resource:"form",queryTerm:"basic",varName:"basic",displayName:"Basic Form - This form contains only the common/core elements needed for most forms"},reg:{resource:"encountertype",queryTerm:"reg",varName:"reg",displayName:"REGISTRATION - Registration encounter"},screener:{resource:"encountertype",queryTerm:"screener",varName:"screener",displayName:"SCREENER - Screener encounter"},screenervitals:{resource:"encountertype",queryTerm:"screenervitals",varName:"screenervitals",displayName:"SCREENERVITALS - Screener Vitals encounter"},out:{resource:"encountertype",queryTerm:"out",varName:"out",displayName:"OUTPATIENT - Outpatient encounter"},prescription:{resource:"encountertype",queryTerm:"prescription",varName:"prescription",displayName:"PRESCRIPTION - Prescription encounter"},prescriptionfill:{resource:"encountertype",queryTerm:"prescriptionfill",varName:"prescriptionfill",displayName:"PRESCRIPTIONFILL - Prescriptionfill encounter"},primaryrelative:{resource:"personattributetype",queryTerm:"primary relative",varName:"primaryRelative",displayName:"Primary Relative - Primary Relative"},secondarycontact:{resource:"personattributetype",queryTerm:"secondary contact",varName:"secondaryContact",displayName:"Secondary Contact - Secondary Contact"},primarycontact:{resource:"personattributetype",queryTerm:"primary contact",varName:"primaryContact",displayName:"Primary Contact - Primary Contact"},contactbyphone:{resource:"personattributetype",queryTerm:"contact by phone",varName:"contactByPhone",displayName:"Contact By Phone - Whether to contact this patient by phone"},district:{resource:"personattributetype",queryTerm:"district",varName:"district",displayName:"District - District"},tehsil:{resource:"personattributetype",queryTerm:"tehsil",varName:"tehsil",displayName:"Tehsil - Tehsil"},occupation:{resource:"personattributetype",queryTerm:"occupation",varName:"occupation",displayName:"Occupation - Occupation"},education:{resource:"personattributetype",queryTerm:"education",varName:"education",displayName:"Education - Education"},caste:{resource:"personattributetype",queryTerm:"caste",varName:"caste",displayName:"Caste - Caste"},oldpatientidentificationnumber:{resource:"personattributetype",queryTerm:"old patient identification number",varName:"oldPatientIdentificationNumber",displayName:"Old Patient Identification Number - Old Patient Identification Number"},};var idPattern=/.*RaxaEMR Identification Number.*/;var WHO_BMI_VSUNDERWEIGHT=15;var WHO_BMI_SUNDERWEIGHT=16;var WHO_BMI_UNDERWEIGHT=18.5;var WHO_BMI_NORMAL=25;var WHO_BMI_OVERWEIGHT=30;var WHO_BMI_OBESE=35;var WHO_BMI_SOBESE=40;var BMI_MAX=60;var BMI_HEIGHT_MAX=300;var BMI_HEIGHT_MIN=0;var BMI_WEIGHT_MAX=800;var BMI_WEIGHT_MIN=0;var KEY={ENTER:13};var keyMap={};var REG_PAGES={HOME:{value:0,name:"home"},REG_1:{value:1,name:"registrationpart1"},REG_CONFIRM:{value:2,name:"registrationconfirm"},ILLNESS_DETAILS:{value:3,name:"illnessdetails"},REG_BMI:{value:4,name:"registrationbmi"},SEARCH_1:{value:5,name:"searchpart1"},SEARCH_2:{value:6,name:"searchpart2"},SEARCH_CONFIRM:{value:7,name:"searchconfirm"}};var UITIME=120000;var ONEDAYMS=86400000;var MONTHSINAYEAR=12;var diffinUTC_GMT=5.5;var TIME_BEFORE_NOW=0.1;var Util={PAGES:{},DOCTOR_ATTRIBUTE:"isOutpatientDoctor - true",DEFAULT_LOCATION:"GAN",OPEN_MRS_MIN_AGE:0,OPEN_MRS_MAX_AGE:120,maxLengthListener:function(a){return{keyup:function(f,h,c){var g=f.getValue()+"";var d=g.length;var b=a;if(d>b){f.setValue(g.substring(0,b));return false}}}},getUTCGMTdiff:function(){return diffinUTC_GMT},getUiTime:function(){return UITIME},daysFromNow:function(c){var a=new Date(c);var b=new Date();return Math.ceil((a.getTime()-b.getTime())/ONEDAYMS)},monthsFromNow:function(c){var a=new Date(c);var b=new Date();return Math.ceil((a.getFullYear()-b.getFullYear())*MONTHSINAYEAR+a.getMonth()-b.getMonth())},daysBetween:function(b,c){var a=new Date(c);var d=new Date(b);return Math.abs(Math.ceil((a.getTime()-d.getTime())/ONEDAYMS))},monthsBetween:function(b,c){var a=new Date(c);var d=new Date(b);return Math.abs((a.getFullYear()-d.getFullYear())*MONTHSINAYEAR+a.getMonth()-d.getMonth())},getCurrentTime:function(){return this.Datetime(new Date(),this.getUTCGMTdiff())},Datetime:function(f,a){if(typeof a=="undefined"){a=0}a=a+TIME_BEFORE_NOW;var e=60000;var b=new Date(f-(60*a)*e);function c(d){return d<10?"0"+d:d}return b.getFullYear()+"-"+c(b.getMonth()+1)+"-"+c(b.getDate())+"T"+c(b.getHours())+":"+c(b.getMinutes())+":"+c(b.getSeconds())+"Z"},getTimeoutLimit:function(){return timeoutLimit},getHospitalName:function(){return hospitalName},getBasicAuthHeaders:function(){var a={Authorization:localStorage.getItem("basicAuthHeader"),Accept:"application/json","Content-Type":"application/json"};return a},logoutUser:function(){Ext.Ajax.request({url:HOST+"/ws/rest/v1/session",withCredentials:true,useDefaultXhrHeader:false,method:"DELETE"});localStorage.removeItem("basicAuthHeader");localStorage.removeItem("privileges");localStorage.removeItem("Username");localStorage.removeItem("loggedInUser");localStorage.removeItem("loggedInProvider");window.location.hash="Login"},uuidLoadedSuccessfully:function(){if(this.checkAllUuidsLoaded()){return true}else{window.location="../"}},checkAllUuidsLoaded:function(){var d=this;var f=0;var e=0;var a="";for(var b in resourceUuid){f++;var c=resourceUuid[b].varName+"Uuid"+resourceUuid[b].resource;if(localStorage.getItem(c)!=null){e++}else{a+=(c+", ");this.getAttributeFromREST(resourceUuid[b].resource,resourceUuid[b].queryTerm,resourceUuid[b].varName,resourceUuid[b].displayName)}}console.log("UUIDs expected = "+f+". UUIDs loaded "+e);if(f==e){return true}else{console.log("Uuid's which failed to load were:"+a);return false}},saveBasicAuthHeader:function(d,a){Util.logoutUser();var b=new XMLHttpRequest();b.open("GET",HOST+"/ws/rest/v1/session",false);b.setRequestHeader("Accept","application/json");b.setRequestHeader("Authorization","Basic "+window.btoa(d+":"+a));b.send();if(b.status=="200"){var c=Ext.decode(b.responseText).authenticated;if(c){localStorage.setItem("basicAuthHeader","Basic "+window.btoa(d+":"+a))}else{localStorage.removeItem("basicAuthHeader")}}},getModules:function(){return["login","screener","registration","registrationextjs4","pharmacy","chw","outpatient","laboratory","patientfacing"]},getSelectModules:function(){var b=[];for(var a=0;a<Util.getModules().length;a++){var e=Util.getModules()[a];var c="";switch(e){case"login":c="Dashboard";break;case"screener":c="Screener";break;case"registration":c="Registration";break;case"registrationextjs4":c="Registration Desktop";break;case"pharmacy":c="Pharmacy";break;case"chw":c="Chw";break;case"outpatient":c="Opd";break;case"laboratory":c="Laboratory";break;case"patientfacing":c="Patient Facing";break;default:c="You dont have permission to access any Module";break}var d={text:c,value:Util.getModules()[a]};b.push(d)}return b},getApps:function(){return["gotStatins","problemList"]},getDeviceId:function(){var c;if(localStorage.getItem("deviceId")===null){var b=[];for(var a=0;a<6;a++){b[a]=(Math.floor(Math.random()*10))}c=b.join("");localStorage.setItem("deviceId",c);console.log("6-digit randomly generated Device Id: "+c+" & is stored in localStorage")}else{c=localStorage.getItem("deviceId");console.log("6-digit randomly generated Device Id that was stored in localStorage:"+c)}return c},getPatientIdentifier:function(){var a=arguments[0];if(arguments[0]===undefined){a=this.DEFAULT_LOCATION}var c=a+(Math.floor(Math.random()*1000000)).toString();url=HOST+"/ws/rest/v1/patient?q="+c,xmlHttp=new XMLHttpRequest();xmlHttp.open("GET",url,false);xmlHttp.setRequestHeader("Accept","application/json");xmlHttp.setRequestHeader("Authorization",localStorage.getItem("basicAuthHeader"));xmlHttp.send();var b=JSON.parse(xmlHttp.responseText);if(xmlHttp.status=="200"){if(b.results.length>0){return(Util.getPatientIdentifier())}else{return c}}},platformizeModelConfig:function(b){if(Ext.versions.extjs){return b}else{if(Ext.versions.touch){var a={extend:b.extend,config:b};delete a.config.extend;return a}else{Ext.Error.raise("Could not recognize Library")}}},getAttributeFromREST:function(a,d,c,b){Ext.Ajax.request({url:HOST+"/ws/rest/v1/"+a+"?q="+d,method:"GET",disableCaching:false,headers:Util.getBasicAuthHeaders(),failure:function(e){console.log("GET failed with response status: "+e.status)},success:function(e){console.log("getAttributeFromRest ... resource: "+a+", queryParameter: "+d+", varName:"+c+" RESPONSE: "+e.responseText);for(var f=0;f<JSON.parse(e.responseText).results.length;++f){if(JSON.parse(e.responseText).results[f].display==b){if(a!="location"){localStorage.setItem(c+"Uuid"+a,JSON.parse(e.responseText).results[f].uuid)}else{localStorage.setItem(c+"Uuid"+a,b)}}}}})},getPersonUuidFromProviderUuid:function(a){Ext.Ajax.request({url:HOST+"/ws/rest/v1/provider/"+a,method:"GET",disableCaching:false,headers:Util.getBasicAuthHeaders(),failure:function(b){console.log("GET failed with response status: "+b.status)},success:function(b){if(console.log(JSON.parse(b.responseText).person.uuid)!=null){return JSON.parse(b.responseText).person.uuid}else{return"provider with given uuid does not exist"}}})},KeyMapButton:function(b,a){if(keyMap.keyName!=null){this.DestroyKeyMapButton(a)}keyMap.keyName=Ext.create("Ext.util.KeyMap",Ext.getBody(),[{key:a,shift:false,ctrl:false,fn:function(){var c=Ext.getCmp(b);c.fireEvent("click",c)}}])},DestroyKeyMapButton:function(a){keyMap.keyName.destroy(true);keyMap.keyName=null},getProviderUuidFromPersonUuid:function(a){Ext.Ajax.request({url:HOST+"/ws/rest/v1/provider?v=full",method:"GET",disableCaching:false,headers:Util.getBasicAuthHeaders(),failure:function(b){console.log("GET failed with response status: "+b.status)},success:function(b){var c=JSON.parse(b.responseText).results;for(i=0;i<c.length;i++){if(c[i].person.uuid===a){console.log("success");localStorage.setItem("loggedInProvider",c[i].uuid);return c[i].uuid}}return"provider with given uuid not found"}})},getLoggedInProviderUuid:function(){if(!localStorage.getItem("loggedInUser")){return"provider is not logged in"}if(localStorage.getItem("loggedInProvider")){return localStorage.getItem("loggedInProvider")}this.getProviderUuidFromPersonUuid(localStorage.getItem("loggedInUser"));return"setting provider uuid now"},checkModulePrivilege:function(b){var a=localStorage.getItem("privileges");if(a!==null&&(a.indexOf("RaxaEmrView "+b)!==-1||a.indexOf("all privileges")!==-1)){return true}else{window.location="../"}},sendAlert:function(b){var a=Ext.encode(b);Ext.Ajax.request({url:HOST+"/ws/rest/v1/raxacore/raxaalert",method:"POST",disableCaching:false,headers:Util.getBasicAuthHeaders(),params:a,failure:function(c){console.log("POST alert failed with response status: "+c.status)}})},getMessageLoadError:function(){return"Unable to read from server"},getMessageSyncError:function(){return"Unable to write to server"}};